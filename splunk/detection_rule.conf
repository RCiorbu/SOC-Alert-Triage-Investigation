# Example detection rule (for documentation)
[BruteForce_Detection]
description = Detect >=5 failed auth attempts from a single IP within a short window (candidate brute force)
search = index=main sourcetype=syslog (sshd OR webapp) 
        | rex "from (?<src_ip>\d+\.\d+\.\d+\.\d+)"
        | stats count(eval(match(_raw, "Failed password|login failure"))) AS failed, count(eval(match(_raw, "Accepted password|login success"))) AS success BY src_ip
        | where failed >= 5 AND success < 1
schedule = */5 * * * *
severity = high
actions = notable,event,email
notes = Tune 'failed' threshold and time window to reduce false positives. Consider adding IP reputation enrichment.
